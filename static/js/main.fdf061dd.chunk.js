(this["webpackJsonpstudents-task-tracker"]=this["webpackJsonpstudents-task-tracker"]||[]).push([[0],{109:function(e,t,n){e.exports=n(189)},114:function(e,t,n){},115:function(e,t,n){},189:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(26),s=n.n(o),u=(n(114),n(115),n(75)),c=n(3),i=n(8),l=n(56),d=n(191),k=n(80),T={display:"flex"},m=Object(c.a)({},T,{alignItems:"center"}),E=Object(c.a)({},m,{justifyContent:"center"}),f=Object(c.a)({},m,{justifyContent:"space-around"}),b=(Object(c.a)({},E,{height:"80vh"}),Object(c.a)({},T,{flexFlow:"column"})),p=Object(c.a)({},b,{alignItems:"center"}),h=Object(c.a)({},p,{justifyContent:"center"}),g=(Object(c.a)({},p,{justifyContent:"space-around"}),Object(c.a)({},h,{minHeight:"80vh"})),v=function(e){var t=e.name,n=e.studentSetNameCallback,a=e.goToSessionCallback,o=e.error,s=e.loading;return r.a.createElement("div",{style:g},!!o&&r.a.createElement("div",{style:{color:"red"}},o),s&&r.a.createElement("div",{style:{color:"orange"}},"Loading..."),r.a.createElement(d.a,{placeholder:"Name Surname",value:t,onChange:function(e){return n(e.currentTarget.value)},style:{width:"250px",margin:"20px"},disabled:s}),r.a.createElement(k.a,{onClick:a,disabled:s,type:"primary"},"Go to session"))},S=n(6),C=function(e){return{type:"STUDENT/LOADING",loading:e}},N=function(e,t,n,a){return{type:"STUDENT/SUCCESS",studentToken:e,taskCount:n,name:t,currentTaskNumber:a}},O=function(e){return{type:"STUDENT/ERROR",error:e}},y=function(e){return{type:"STUDENT/SET_NAME",name:e}},j=n(10),w=n.n(j),x=n(54),R=n.n(x),U="https://pacific-lake-87230.herokuapp.com",M=R.a.create({baseURL:U}),_=function(e,t){return M.post("/student",{name:e,sessionToken:t})},D=function(e,t,n,a){return M.put("/student",{name:n,sessionToken:t,studentToken:e,currentTaskNumber:a})},L=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:604800;document.cookie="".concat(e,"=").concat(t,";max-age=").concat(n,";path=/")},I=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},A=function(){return function(e,t){var n,a,r,o,s,u;return w.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(n=t().student,a=n.name,r=n.currentTaskNumber,o=I("sessionToken"),s=I("studentToken"),e(C(!0)),c.prev=4,s){c.next=8;break}throw{message:"no studentToken"};case 8:return c.next=10,w.a.awrap(D(s,o||"",a,r));case 10:(u=c.sent).data.error?(u.data.taskCount&&e(N(s,a,u.data.taskCount,r)),"bad sessionToken"!==u.data.error&&"session is finished"!==u.data.error&&"session don't have student with your studentToken"!==u.data.error||(alert(u.data.error),L("studentToken","",-1e3),L("sessionToken","",-1e3)),e(O(u.data.error))):(e(N(s,u.data.name,u.data.taskCount,u.data.currentTaskNumber)),console.log("Student updateStudent Success!",u)),c.next=18;break;case 14:c.prev=14,c.t0=c.catch(4),e(O(c.t0.message)),console.log("Student updateStudent Error!",c.t0);case 18:case"end":return c.stop()}}),null,null,[[4,14]])}},G=function(e){var t=e.sessionToken,n=Object(S.c)((function(e){return e.student})),o=Object(S.b)(),s=Object(a.useState)(!0),u=Object(l.a)(s,2),c=u[0],d=u[1];Object(a.useEffect)((function(){t&&(L("sessionToken",t),L("studentToken","",-1e3),o(function(e){return{type:"STUDENT/SET_SESSION_TOKEN",sessionToken:e}}(t)))}),[]);return I("studentToken")&&!c?r.a.createElement(i.a,{to:ce}):r.a.createElement(v,{name:n.name,error:n.error,loading:n.loading,studentSetNameCallback:function(e){o(y(e))},goToSessionCallback:function(){o((function(e,t){var n,a,r;return w.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=t().student.name,a=I("sessionToken"),e(C(!0)),o.prev=3,a){o.next=7;break}throw alert("sessionToken: "+a),{message:"no sessionToken"};case 7:return o.next=9,w.a.awrap(_(n,a));case 9:(r=o.sent).data.error?("bad sessionToken"!==r.data.error&&"session is finished"!==r.data.error||(alert(r.data.error),L("studentToken","",-1e3),L("sessionToken","",-1e3)),e(O(r.data.error))):(console.log("studentToken:",r.data.studentToken),L("studentToken",r.data.studentToken),e(N(r.data.studentToken,r.data.name,r.data.taskCount,r.data.currentTaskNumber)),console.log("Student goToSession Success!",r)),o.next=17;break;case 13:o.prev=13,o.t0=o.catch(3),e(O(o.t0.message)),console.log("Student goToSession Error!",o.t0);case 17:case"end":return o.stop()}}),null,null,[[3,13]])})),d(!1)}})},B=n(192),W=function(e){var t=e.name,n=e.taskCount,a=e.currentTaskNumber,o=e.error,s=e.loading,u=e.studentSetNameCallback,c=e.studentSetCurrentTaskNumberCallback,i=e.updateStudentCallback;return r.a.createElement("div",{style:g},!!o&&r.a.createElement("div",{style:{color:"red"}},o),s?r.a.createElement("div",{style:{color:"orange"}},"Loading..."):r.a.createElement("div",null,r.a.createElement("br",null)),r.a.createElement(d.a,{placeholder:"Name Surname",value:t,onChange:function(e){return u(e.currentTarget.value)},onBlur:i,style:{width:"250px",margin:"20px"},disabled:s}),"\u042f \u0441\u0434\u0435\u043b\u0430\u043b(\u0430)",r.a.createElement(B.a,{min:0,max:n,value:a,onChange:function(e){return c(e||0)},disabled:s}),"\u0442\u0430\u0441\u043a(\u0443/\u0438/\u043e\u043a)!")},K=function(){var e=Object(S.c)((function(e){return e.student})),t=Object(S.b)();Object(a.useEffect)((function(){t(A())}),[]);var n=function(){t(A())};return I("studentToken")?r.a.createElement(W,{name:e.name,taskCount:e.taskCount,currentTaskNumber:e.currentTaskNumber,error:e.error,loading:e.loading,studentSetNameCallback:function(e){t(y(e))},studentSetCurrentTaskNumberCallback:function(e){t(function(e){return{type:"STUDENT/SET_CURRENT_TASK_NUMBER",currentTaskNumber:e}}(e)),n()},updateStudentCallback:n}):r.a.createElement(i.a,{to:ue})},$=function(e){var t=e.taskCount,n=e.error,a=e.loading,o=e.mentorSetTaskCountCallback,s=e.startSessionCallback;return r.a.createElement("div",{style:g},!!n&&r.a.createElement("div",{style:{color:"red"}},n),a&&r.a.createElement("div",{style:{color:"orange"}},"Loading..."),r.a.createElement("div",{style:E},r.a.createElement(B.a,{min:0,value:t,onChange:function(e){return o(e||0)},style:{margin:"20px"},disabled:a}),r.a.createElement(k.a,{type:"primary",onClick:s,disabled:a},"START")))},F=function(e){return{type:"MENTOR/LOADING",loading:e}},H=function(e,t,n){return{type:"MENTOR/GET_STUDENTS_SUCCESS",sessionToken:e,taskCount:t,students:n}},J=function(e){return{type:"MENTOR/ERROR",error:e}},q=R.a.create({baseURL:U}),X=function(e){return q.post("/session",{taskCount:e})},Y=function(e){return q.get("/session?authorToken="+e)},Z=function(e,t,n){return q.put("/session",{authorToken:e,taskCount:t,finishSession:n})},z=function(e,t){return q.delete("/student?authorToken="+e+"&studentToken="+t)},P=function(){return function(e,t){var n,a;return w.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=I("authorToken"),e(F(!0)),t.prev=2,n){t.next=5;break}throw{message:"no authorToken"};case 5:return t.next=7,w.a.awrap(Y(n));case 7:(a=t.sent).data.error?("bad authorToken"!==a.data.error&&"session is finished"!==a.data.error||(alert(a.data.error),L("authorToken","",-1e3),L("sessionToken","",-1e3)),e(J(a.data.error))):(L("sessionToken",a.data.sessionToken),e(H(a.data.sessionToken,a.data.taskCount,a.data.students)),console.log("Mentor Get students Success!",a)),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),e(J(t.t0.message)),console.log("Mentor Get students Error!",t.t0);case 15:case"end":return t.stop()}}),null,null,[[2,11]])}},Q=function(e,t){return function(n,a){var r,o;return w.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=I("authorToken"),n(F(!0)),a.prev=2,r){a.next=5;break}throw{message:"no authorToken"};case 5:return a.next=7,w.a.awrap(Z(r,e,t));case 7:(o=a.sent).data.error?("bad authorToken"!==o.data.error&&"session is finished"!==o.data.error||(alert(o.data.error),L("authorToken","",-1e3),L("sessionToken","",-1e3)),n(J(o.data.error))):(L("sessionToken",o.data.sessionToken),n(H(o.data.sessionToken,o.data.taskCount,o.data.students)),console.log("Mentor Update session Success!",o)),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(2),n(J(a.t0.message)),console.log("Mentor Update session Error!",a.t0);case 15:case"end":return a.stop()}}),null,null,[[2,11]])}},V=function(){var e=Object(S.c)((function(e){return e.session})),t=Object(S.b)();return I("authorToken")?r.a.createElement(i.a,{to:le}):r.a.createElement($,{taskCount:e.taskCount,mentorSetTaskCountCallback:function(e){t(function(e){return{type:"MENTOR/SET_TOTAL_COUNT",taskCount:e}}(e))},startSessionCallback:function(){t((function(e,t){var n,a;return w.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t().session.taskCount,e(F(!0)),r.prev=2,r.next=5,w.a.awrap(X(n));case 5:(a=r.sent).data.error?e(J(a.data.error)):(L("sessionToken",a.data.sessionToken),L("authorToken",a.data.authorToken),e((o=a.data.sessionToken,s=a.data.authorToken,{type:"MENTOR/SUCCESS",sessionToken:o,authorToken:s})),console.log("Mentor Start Success!",a)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(2),e(J(r.t0.message)),console.log("Mentor Start Error!",r.t0);case 13:case"end":return r.stop()}var o,s}),null,null,[[2,9]])}))},error:e.error,loading:e.loading})},ee=n(190),te=function(e){var t=e.taskCount,n=e.currentTaskNumber,a=e.minCount,o=e.name,s=e.deleteStudentCallback,u=Math.floor(n/t*100),i=t===n?"lime":n===a?"red":"blue";return r.a.createElement("div",{style:Object(c.a)({},E,{width:"95vw",justifyContent:"space-between"})},r.a.createElement("span",{style:{margin:"10px",width:"20vw",wordWrap:"break-word"}},o),r.a.createElement("div",{style:{minWidth:"30vw"}},r.a.createElement(ee.a,{strokeLinecap:"square",percent:u,format:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.a.createElement("div",null,n,"/",t," (",u,"%)")},strokeColor:i,strokeWidth:4})),r.a.createElement(k.a,{onClick:s,style:{marginLeft:"20px",marginTop:"6px"},type:"danger"},"X"))},ne=function(e){var t=e.error,n=e.loading,a=e.taskCount,o=e.students,s=e.deleteStudentCallback,u=o.reduce((function(e,t){return t.currentTaskNumber<e?t.currentTaskNumber:e}),a);return r.a.createElement("div",{style:p},!!t&&r.a.createElement("div",{style:{color:"red"}},t),n?r.a.createElement("div",{style:{color:"orange"}},"Loading..."):r.a.createElement("div",null,"..."),o.map((function(e){return r.a.createElement(te,{name:e.name,taskCount:a,currentTaskNumber:e.currentTaskNumber,minCount:u,deleteStudentCallback:function(){return s(e.studentToken)}})})))},ae=function(){var e=Object(S.c)((function(e){return e.session})),t=Object(S.b)();Object(a.useEffect)((function(){t(P());var e=setInterval((function(){t(P())}),3e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(ne,{error:e.error,loading:e.loading,taskCount:e.taskCount,students:e.students.sort((function(e,t){return e.currentTaskNumber-t.currentTaskNumber})),deleteStudentCallback:function(e){t(function(e){return function(t,n){var a,r;return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=I("authorToken"),t(F(!0)),n.prev=2,a){n.next=5;break}throw{message:"no authorToken"};case 5:return n.next=7,w.a.awrap(z(a,e));case 7:(r=n.sent).data.error?("bad authorToken"!==r.data.error&&"session is finished"!==r.data.error||(alert(r.data.error),L("authorToken","",-1e3),L("sessionToken","",-1e3)),t(J(r.data.error))):(L("sessionToken",r.data.sessionToken),t(H(r.data.sessionToken,r.data.taskCount,r.data.students)),console.log("Mentor Update session Success!",r)),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(2),t(J(n.t0.message)),console.log("Mentor Update session Error!",n.t0);case 15:case"end":return n.stop()}}),null,null,[[2,11]])}}(e))}})},re=function(e){var t=e.taskCount,n=e.link,a=e.mentorLink,o=e.finishSession,s=e.updateSessionCallback;return r.a.createElement("div",{style:g},n,r.a.createElement("div",{style:Object(c.a)({},f,{width:"100vw"})},r.a.createElement(B.a,{min:1,value:t,style:{margin:"20px"},onChange:function(e){return s(e||1)}}),r.a.createElement(k.a,{type:"danger",onClick:o},"FINISH SESSION")),r.a.createElement(ae,null),a)},oe="http://IgnatZakalinsky.github.io/students-task-tracker/#",se=function(){var e=Object(S.c)((function(e){return e.session})),t=Object(S.b)(),n=Object(a.useState)(!1),o=Object(l.a)(n,2),s=o[0],u=o[1],c=I("authorToken");if(!c)return r.a.createElement(i.a,{to:ie});var d=I("sessionToken"),k=oe+ue+"/"+d,T=oe+de+"/"+d+"/"+c;return r.a.createElement(re,{taskCount:e.taskCount,link:k,mentorLink:T,finishSession:function(){t(Q(e.taskCount,!0)),L("authorToken","",-1e3),L("sessionToken","",-1e3),u(!s)},updateSessionCallback:function(e){t(Q(e,!1))}})},ue="/student-login",ce="/student-select",ie="/mentor-start",le="/mentor-session",de="/mentor-get-author-token",ke=function(){return r.a.createElement("div",{style:Object(c.a)({},h,{width:"100vw"})},r.a.createElement(i.b,{exact:!0,path:"/",render:function(){return r.a.createElement(i.a,{to:ie})}}),r.a.createElement(i.b,{path:ue+"/:sessionToken",render:function(e){return r.a.createElement(G,{sessionToken:e.match.params.sessionToken})}}),r.a.createElement(i.b,{path:ue,exact:!0,render:function(){return r.a.createElement("div",{style:g},r.a.createElement("span",null,"You don't have sessionToken in URL,"),r.a.createElement("span",null,"get a new link!"))}}),r.a.createElement(i.b,{path:ce,render:function(){return r.a.createElement(K,null)}}),r.a.createElement(i.b,{path:ie,render:function(){return r.a.createElement(V,null)}}),r.a.createElement(i.b,{path:le,render:function(){return r.a.createElement(se,null)}}),r.a.createElement(i.b,{path:de+"/:sessionToken/:authorToken",render:function(e){return L("sessionToken",e.match.params.sessionToken),L("authorToken",e.match.params.authorToken),r.a.createElement(i.a,{to:le})}}))},Te=function(){return r.a.createElement("div",null,r.a.createElement(ke,null))},me=n(41),Ee=n(107),fe={name:"",sessionToken:"",studentToken:"",taskCount:0,currentTaskNumber:0,loading:!1,error:""},be={taskCount:7,sessionToken:"",authorToken:"",loading:!1,error:"",students:[]},pe=Object(me.c)({student:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STUDENT/LOADING":return Object(c.a)({},e,{loading:t.loading,error:""});case"STUDENT/SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",studentToken:t.studentToken,taskCount:t.taskCount,name:t.name,currentTaskNumber:t.currentTaskNumber});case"STUDENT/ERROR":return Object(c.a)({},e,{loading:!1,error:t.error});case"STUDENT/SET_NAME":return Object(c.a)({},e,{name:t.name,loading:!1,error:""});case"STUDENT/SET_CURRENT_TASK_NUMBER":return Object(c.a)({},e,{currentTaskNumber:t.currentTaskNumber,loading:!1,error:""});case"STUDENT/SET_SESSION_TOKEN":return Object(c.a)({},e,{sessionToken:t.sessionToken,loading:!1,error:""});default:return e}},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MENTOR/SET_TOTAL_COUNT":return Object(c.a)({},e,{loading:!1,error:"",taskCount:t.taskCount});case"MENTOR/LOADING":return Object(c.a)({},e,{loading:t.loading,error:""});case"MENTOR/SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",authorToken:t.authorToken,sessionToken:t.sessionToken});case"MENTOR/GET_STUDENTS_SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",sessionToken:t.sessionToken,taskCount:t.taskCount,students:t.students});case"MENTOR/ERROR":return Object(c.a)({},e,{loading:!1,error:t.error});default:return e}}}),he=Object(me.d)(pe,Object(me.a)(Ee.a)),ge=he;window.store=he;n(188);var ve=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(u.a,null,r.a.createElement(S.a,{store:ge},r.a.createElement(Te,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[109,1,2]]]);
//# sourceMappingURL=main.fdf061dd.chunk.js.map