(this["webpackJsonpstudents-task-tracker"]=this["webpackJsonpstudents-task-tracker"]||[]).push([[0],{109:function(e,t,n){e.exports=n(189)},114:function(e,t,n){},115:function(e,t,n){},189:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(27),s=n.n(o),u=(n(114),n(115),n(23)),c=n(3),i=n(42),l=n(8),d=n(191),k=n(80),T={display:"flex"},m=Object(c.a)({},T,{alignItems:"center"}),E=Object(c.a)({},m,{justifyContent:"center"}),b=Object(c.a)({},m,{justifyContent:"space-around"}),f=Object(c.a)({},E,{height:"80vh"}),h=Object(c.a)({},T,{flexFlow:"column"}),p=Object(c.a)({},h,{alignItems:"center"}),g=Object(c.a)({},p,{justifyContent:"center"}),S=(Object(c.a)({},p,{justifyContent:"space-around"}),Object(c.a)({},g,{minHeight:"80vh"})),v=function(e){var t=e.name,n=e.studentSetNameCallback,a=e.goToSessionCallback,o=e.error,s=e.loading;return r.a.createElement("div",{style:S},!!o&&r.a.createElement("div",{style:{color:"red"}},o),s&&r.a.createElement("div",{style:{color:"orange"}},"Loading..."),r.a.createElement(d.a,{placeholder:"Name Surname",value:t,onChange:function(e){return n(e.currentTarget.value)},style:{width:"400px",margin:"20px"},disabled:s}),r.a.createElement(k.a,{onClick:a,disabled:s,type:"primary"},"Go to session"))},C=n(6),O=function(e){return{type:"STUDENT/LOADING",loading:e}},N=function(e,t,n,a){return{type:"STUDENT/SUCCESS",studentToken:e,taskCount:n,name:t,currentTaskNumber:a}},y=function(e){return{type:"STUDENT/ERROR",error:e}},j=function(e){return{type:"STUDENT/SET_NAME",name:e}},w=n(10),x=n.n(w),R=n(56),U=n.n(R),M="https://pacific-lake-87230.herokuapp.com",_=U.a.create({baseURL:M}),D=function(e,t){return _.post("/student",{name:e,sessionToken:t})},L=function(e,t,n,a){return _.put("/student",{name:n,sessionToken:t,studentToken:e,currentTaskNumber:a})},I=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:604800;document.cookie="".concat(e,"=").concat(t,";max-age=").concat(n,";path=/")},A=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},G=function(){return function(e,t){var n,a,r,o,s,u;return x.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(n=t().student,a=n.name,r=n.currentTaskNumber,o=A("sessionToken"),s=A("studentToken"),e(O(!0)),c.prev=4,s){c.next=8;break}throw{message:"no studentToken"};case 8:return c.next=10,x.a.awrap(L(s,o||"",a,r));case 10:(u=c.sent).data.error?(u.data.taskCount&&e(N(s,a,u.data.taskCount,r)),"bad sessionToken"!==u.data.error&&"session is finished"!==u.data.error&&"session don't have student with your studentToken"!==u.data.error||(alert(u.data.error),I("studentToken","",-1e3),I("sessionToken","",-1e3)),e(y(u.data.error))):(e(N(s,u.data.name,u.data.taskCount,u.data.currentTaskNumber)),console.log("Student updateStudent Success!",u)),c.next=18;break;case 14:c.prev=14,c.t0=c.catch(4),e(y(c.t0.message)),console.log("Student updateStudent Error!",c.t0);case 18:case"end":return c.stop()}}),null,null,[[4,14]])}},B=function(e){var t=e.sessionToken,n=Object(C.c)((function(e){return e.student})),o=Object(C.b)(),s=Object(a.useState)(!0),u=Object(i.a)(s,2),c=u[0],d=u[1];Object(a.useEffect)((function(){t&&(I("sessionToken",t),I("studentToken","",-1e3),o(function(e){return{type:"STUDENT/SET_SESSION_TOKEN",sessionToken:e}}(t)))}),[]);return A("studentToken")&&!c?r.a.createElement(l.a,{to:ie}):r.a.createElement(v,{name:n.name,error:n.error,loading:n.loading,studentSetNameCallback:function(e){o(j(e))},goToSessionCallback:function(){o((function(e,t){var n,a,r;return x.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=t().student.name,a=A("sessionToken"),e(O(!0)),o.prev=3,a){o.next=7;break}throw alert("sessionToken: "+a),{message:"no sessionToken"};case 7:return o.next=9,x.a.awrap(D(n,a));case 9:(r=o.sent).data.error?("bad sessionToken"!==r.data.error&&"session is finished"!==r.data.error||(alert(r.data.error),I("studentToken","",-1e3),I("sessionToken","",-1e3)),e(y(r.data.error))):(console.log("studentToken:",r.data.studentToken),I("studentToken",r.data.studentToken),e(N(r.data.studentToken,r.data.name,r.data.taskCount,r.data.currentTaskNumber)),console.log("Student goToSession Success!",r)),o.next=17;break;case 13:o.prev=13,o.t0=o.catch(3),e(y(o.t0.message)),console.log("Student goToSession Error!",o.t0);case 17:case"end":return o.stop()}}),null,null,[[3,13]])})),d(!1)}})},K=n(192),W=function(e){var t=e.name,n=e.taskCount,a=e.currentTaskNumber,o=e.error,s=e.loading,u=e.studentSetNameCallback,c=e.studentSetCurrentTaskNumberCallback,i=e.updateStudentCallback;return r.a.createElement("div",{style:S},!!o&&r.a.createElement("div",{style:{color:"red"}},o),s&&r.a.createElement("div",{style:{color:"orange"}},"Loading..."),r.a.createElement(d.a,{placeholder:"Name Surname",value:t,onChange:function(e){return u(e.currentTarget.value)},onBlur:i,style:{width:"400px",margin:"20px"},disabled:s}),r.a.createElement(K.a,{min:0,max:n,value:a,onChange:function(e){return c(e||0)},disabled:s}))},$=function(){var e=Object(C.c)((function(e){return e.student})),t=Object(C.b)();Object(a.useEffect)((function(){t(G())}),[]);var n=function(){t(G())};return A("studentToken")?r.a.createElement(W,{name:e.name,taskCount:e.taskCount,currentTaskNumber:e.currentTaskNumber,error:e.error,loading:e.loading,studentSetNameCallback:function(e){t(j(e))},studentSetCurrentTaskNumberCallback:function(e){t(function(e){return{type:"STUDENT/SET_CURRENT_TASK_NUMBER",currentTaskNumber:e}}(e)),n()},updateStudentCallback:n}):r.a.createElement(l.a,{to:ce})},F=function(e){var t=e.taskCount,n=e.error,a=e.loading,o=e.mentorSetTaskCountCallback,s=e.startSessionCallback;return r.a.createElement("div",{style:S},!!n&&r.a.createElement("div",{style:{color:"red"}},n),a&&r.a.createElement("div",{style:{color:"orange"}},"Loading..."),r.a.createElement("div",{style:E},r.a.createElement(K.a,{min:0,value:t,onChange:function(e){return o(e||0)},style:{margin:"20px"},disabled:a}),r.a.createElement(k.a,{type:"primary",onClick:s,disabled:a},"START")))},H=function(e){return{type:"MENTOR/LOADING",loading:e}},J=function(e,t,n){return{type:"MENTOR/GET_STUDENTS_SUCCESS",sessionToken:e,taskCount:t,students:n}},q=function(e){return{type:"MENTOR/ERROR",error:e}},X=U.a.create({baseURL:M}),Y=function(e){return X.post("/session",{taskCount:e})},Z=function(e){return X.get("/session?authorToken="+e)},z=function(e,t,n){return X.put("/session",{authorToken:e,taskCount:t,finishSession:n})},P=function(e,t){return X.delete("/student?authorToken="+e+"&studentToken="+t)},Q=function(){return function(e,t){var n,a;return x.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=A("authorToken"),e(H(!0)),t.prev=2,n){t.next=5;break}throw{message:"no authorToken"};case 5:return t.next=7,x.a.awrap(Z(n));case 7:(a=t.sent).data.error?("bad authorToken"!==a.data.error&&"session is finished"!==a.data.error||(alert(a.data.error),I("authorToken","",-1e3),I("sessionToken","",-1e3)),e(q(a.data.error))):(I("sessionToken",a.data.sessionToken),e(J(a.data.sessionToken,a.data.taskCount,a.data.students)),console.log("Mentor Get students Success!",a)),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),e(q(t.t0.message)),console.log("Mentor Get students Error!",t.t0);case 15:case"end":return t.stop()}}),null,null,[[2,11]])}},V=function(e,t){return function(n,a){var r,o;return x.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=A("authorToken"),n(H(!0)),a.prev=2,r){a.next=5;break}throw{message:"no authorToken"};case 5:return a.next=7,x.a.awrap(z(r,e,t));case 7:(o=a.sent).data.error?("bad authorToken"!==o.data.error&&"session is finished"!==o.data.error||(alert(o.data.error),I("authorToken","",-1e3),I("sessionToken","",-1e3)),n(q(o.data.error))):(I("sessionToken",o.data.sessionToken),n(J(o.data.sessionToken,o.data.taskCount,o.data.students)),console.log("Mentor Update session Success!",o)),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(2),n(q(a.t0.message)),console.log("Mentor Update session Error!",a.t0);case 15:case"end":return a.stop()}}),null,null,[[2,11]])}},ee=function(){var e=Object(C.c)((function(e){return e.session})),t=Object(C.b)();return A("authorToken")?r.a.createElement(l.a,{to:de}):r.a.createElement(F,{taskCount:e.taskCount,mentorSetTaskCountCallback:function(e){t(function(e){return{type:"MENTOR/SET_TOTAL_COUNT",taskCount:e}}(e))},startSessionCallback:function(){t((function(e,t){var n,a;return x.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t().session.taskCount,e(H(!0)),r.prev=2,r.next=5,x.a.awrap(Y(n));case 5:(a=r.sent).data.error?e(q(a.data.error)):(I("sessionToken",a.data.sessionToken),I("authorToken",a.data.authorToken),e((o=a.data.sessionToken,s=a.data.authorToken,{type:"MENTOR/SUCCESS",sessionToken:o,authorToken:s})),console.log("Mentor Start Success!",a)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(2),e(q(r.t0.message)),console.log("Mentor Start Error!",r.t0);case 13:case"end":return r.stop()}var o,s}),null,null,[[2,9]])}))},error:e.error,loading:e.loading})},te=n(190),ne=function(e){var t=e.taskCount,n=e.currentTaskNumber,a=e.minCount,o=e.name,s=e.deleteStudentCallback,u=Math.floor(n/t*100),i=t===n?"lime":n===a?"red":"blue";return r.a.createElement("div",{style:Object(c.a)({},E,{width:"95vw",justifyContent:"space-between"})},r.a.createElement("span",{style:{margin:"10px",width:"20vw",wordWrap:"break-word"}},o),r.a.createElement("div",{style:{width:"30vw"}},r.a.createElement(te.a,{strokeLinecap:"square",percent:u,format:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.a.createElement("div",null,n,"/",t," (",u,"%)")},strokeColor:i,strokeWidth:4})),r.a.createElement(k.a,{onClick:s,style:{marginLeft:"0px",marginTop:"6px"},type:"danger"},"X"))},ae=function(e){var t=e.error,n=e.loading,a=e.taskCount,o=e.students,s=e.deleteStudentCallback,u=o.reduce((function(e,t){return t.currentTaskNumber<e?t.currentTaskNumber:e}),a);return r.a.createElement("div",{style:p},!!t&&r.a.createElement("div",{style:{color:"red"}},t),n?r.a.createElement("div",{style:{color:"orange"}},"Loading..."):r.a.createElement("div",null,"..."),o.map((function(e){return r.a.createElement(ne,{name:e.name,taskCount:a,currentTaskNumber:e.currentTaskNumber,minCount:u,deleteStudentCallback:function(){return s(e.studentToken)}})})))},re=function(){var e=Object(C.c)((function(e){return e.session})),t=Object(C.b)();Object(a.useEffect)((function(){t(Q());var e=setInterval((function(){t(Q())}),3e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(ae,{error:e.error,loading:e.loading,taskCount:e.taskCount,students:e.students,deleteStudentCallback:function(e){t(function(e){return function(t,n){var a,r;return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=A("authorToken"),t(H(!0)),n.prev=2,a){n.next=5;break}throw{message:"no authorToken"};case 5:return n.next=7,x.a.awrap(P(a,e));case 7:(r=n.sent).data.error?("bad authorToken"!==r.data.error&&"session is finished"!==r.data.error||(alert(r.data.error),I("authorToken","",-1e3),I("sessionToken","",-1e3)),t(q(r.data.error))):(I("sessionToken",r.data.sessionToken),t(J(r.data.sessionToken,r.data.taskCount,r.data.students)),console.log("Mentor Update session Success!",r)),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(2),t(q(n.t0.message)),console.log("Mentor Update session Error!",n.t0);case 15:case"end":return n.stop()}}),null,null,[[2,11]])}}(e))}})},oe=function(e){var t=e.taskCount,n=e.link,a=e.mentorLink,o=e.finishSession,s=e.updateSessionCallback;return r.a.createElement("div",{style:S},n,r.a.createElement("div",{style:Object(c.a)({},b,{width:"100vw"})},r.a.createElement(K.a,{min:1,value:t,style:{margin:"20px"},onChange:function(e){return s(e||1)}}),r.a.createElement(k.a,{type:"primary",onClick:o},"FINISH SESSION")),r.a.createElement(re,null),a)},se="http://IgnatZakalinsky.github.io/students-task-tracker/#",ue=function(){var e=Object(C.c)((function(e){return e.session})),t=Object(C.b)(),n=Object(a.useState)(!1),o=Object(i.a)(n,2),s=o[0],u=o[1],c=A("authorToken");if(!c)return r.a.createElement(l.a,{to:le});var d=A("sessionToken"),k=se+ce+"/"+d,T=se+ke+"/"+d+"/"+c;return r.a.createElement(oe,{taskCount:e.taskCount,link:k,mentorLink:T,finishSession:function(){t(V(e.taskCount,!0)),I("authorToken","",-1e3),I("sessionToken","",-1e3),u(!s)},updateSessionCallback:function(e){t(V(e,!1))}})},ce="/student-login",ie="/student-select",le="/mentor-start",de="/mentor-session",ke="/mentor-get-author-token",Te=function(){return r.a.createElement("div",null,r.a.createElement(l.b,{exact:!0,path:"/",render:function(){return r.a.createElement(l.a,{to:le})}}),r.a.createElement(l.b,{path:ce+"/:sessionToken",render:function(e){return r.a.createElement(B,{sessionToken:e.match.params.sessionToken})}}),r.a.createElement(l.b,{path:ce,exact:!0,render:function(){return r.a.createElement("div",{style:f},"You don't have sessionToken in URL, get a new link!")}}),r.a.createElement(l.b,{path:ie,render:function(){return r.a.createElement($,null)}}),r.a.createElement(l.b,{path:le,render:function(){return r.a.createElement(ee,null)}}),r.a.createElement(l.b,{path:de,render:function(){return r.a.createElement(ue,null)}}),r.a.createElement(l.b,{path:ke+"/:sessionToken/:authorToken",render:function(e){return I("sessionToken",e.match.params.sessionToken),I("authorToken",e.match.params.authorToken),r.a.createElement(l.a,{to:de})}}))},me=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],o=t[1];return r.a.createElement("div",{style:Object(c.a)({},b,{height:"10vh",backgroundColor:"#cccccc"})},r.a.createElement(k.a,{onClick:function(){return o(!n)}},n?"hide dev header":"show dev header"),n&&r.a.createElement(u.b,{to:ce},"studentLogin"),n&&r.a.createElement(u.b,{to:ie},"studentSelect"),n&&r.a.createElement(u.b,{to:le},"mentorStart"),n&&r.a.createElement(u.b,{to:de},"mentorSession"),n&&r.a.createElement(u.b,{to:ke},"mentorGetAuthorToken"))},Ee=function(){return r.a.createElement("div",null,r.a.createElement(me,null),r.a.createElement(Te,null))},be=n(43),fe=n(107),he={name:"",sessionToken:"",studentToken:"",taskCount:0,currentTaskNumber:0,loading:!1,error:""},pe={taskCount:7,sessionToken:"",authorToken:"",loading:!1,error:"",students:[]},ge=Object(be.c)({student:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STUDENT/LOADING":return Object(c.a)({},e,{loading:t.loading,error:""});case"STUDENT/SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",studentToken:t.studentToken,taskCount:t.taskCount,name:t.name,currentTaskNumber:t.currentTaskNumber});case"STUDENT/ERROR":return Object(c.a)({},e,{loading:!1,error:t.error});case"STUDENT/SET_NAME":return Object(c.a)({},e,{name:t.name,loading:!1,error:""});case"STUDENT/SET_CURRENT_TASK_NUMBER":return Object(c.a)({},e,{currentTaskNumber:t.currentTaskNumber,loading:!1,error:""});case"STUDENT/SET_SESSION_TOKEN":return Object(c.a)({},e,{sessionToken:t.sessionToken,loading:!1,error:""});default:return e}},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MENTOR/SET_TOTAL_COUNT":return Object(c.a)({},e,{loading:!1,error:"",taskCount:t.taskCount});case"MENTOR/LOADING":return Object(c.a)({},e,{loading:t.loading,error:""});case"MENTOR/SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",authorToken:t.authorToken,sessionToken:t.sessionToken});case"MENTOR/GET_STUDENTS_SUCCESS":return Object(c.a)({},e,{loading:!1,error:"",sessionToken:t.sessionToken,taskCount:t.taskCount,students:t.students});case"MENTOR/ERROR":return Object(c.a)({},e,{loading:!1,error:t.error});default:return e}}}),Se=Object(be.d)(ge,Object(be.a)(fe.a)),ve=Se;window.store=Se;n(188);var Ce=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(u.a,null,r.a.createElement(C.a,{store:ve},r.a.createElement(Ee,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[109,1,2]]]);
//# sourceMappingURL=main.28787ba0.chunk.js.map